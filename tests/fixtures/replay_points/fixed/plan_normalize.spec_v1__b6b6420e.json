{"extras":{"planner_input_v1":{"case_id":"qa_001","id":"planner_input_v1","input":{"feature_name":"qa_001","options":{"plan_only":false},"provider_catalog":{"demo_qa":{"capabilities":["schema","row_query","aggregate","semantic_search"],"name":"demo_qa","selectors_schema":{"oneOf":[{"description":"Request schema description.","properties":{"op":{"const":"schema","default":"schema","title":"Op","type":"string"}},"title":"SchemaRequest","type":"object"},{"description":"Request semantic search results only.","properties":{"entity":{"enum":["customers","products","orders","order_items"],"title":"Entity","type":"string"},"fields":{"items":{"type":"string"},"title":"Fields","type":"array"},"op":{"const":"semantic_only","default":"semantic_only","title":"Op","type":"string"},"query":{"title":"Query","type":"string"},"top_k":{"default":100,"title":"Top K","type":"integer"}},"required":["entity","query"],"title":"SemanticOnlyRequest","type":"object"},{"$defs":{"AggregationSpec":{"description":"Aggregation specification.","properties":{"agg":{"title":"Agg","type":"string"},"alias":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null,"title":"Alias"},"field":{"title":"Field","type":"string"}},"required":["field","agg"],"title":"AggregationSpec","type":"object"},"ComparisonFilter":{"description":"Basic comparison filter.","properties":{"entity":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null,"title":"Entity"},"field":{"title":"Field","type":"string"},"op":{"title":"Op","type":"string"},"type":{"const":"comparison","default":"comparison","title":"Type","type":"string"},"value":{"title":"Value"}},"required":["field","op","value"],"title":"ComparisonFilter","type":"object"},"GroupBySpec":{"description":"Group by specification.","properties":{"alias":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null,"title":"Alias"},"entity":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null,"title":"Entity"},"field":{"title":"Field","type":"string"}},"required":["field"],"title":"GroupBySpec","type":"object"},"LogicalFilter":{"description":"Logical combination of filters.","properties":{"clauses":{"items":{"anyOf":[{"$ref":"#/$defs/ComparisonFilter"},{"$ref":"#/$defs/LogicalFilter"}]},"title":"Clauses","type":"array"},"op":{"default":"and","enum":["and","or"],"title":"Op","type":"string"},"type":{"const":"logical","default":"logical","title":"Type","type":"string"}},"title":"LogicalFilter","type":"object"},"SelectExpr":{"description":"Returned expression.","properties":{"alias":{"anyOf":[{"type":"string"},{"type":"null"}],"default":null,"title":"Alias"},"expr":{"title":"Expr","type":"string"}},"required":["expr"],"title":"SelectExpr","type":"object"},"SemanticClause":{"description":"Semantic search clause for an entity.","properties":{"entity":{"title":"Entity","type":"string"},"fields":{"items":{"type":"string"},"title":"Fields","type":"array"},"mode":{"default":"filter","enum":["filter","boost"],"title":"Mode","type":"string"},"query":{"title":"Query","type":"string"},"threshold":{"anyOf":[{"type":"number"},{"type":"null"}],"default":null,"title":"Threshold"},"top_k":{"default":100,"title":"Top K","type":"integer"}},"required":["entity","query"],"title":"SemanticClause","type":"object"}},"description":"Main relational query request.","properties":{"aggregations":{"items":{"$ref":"#/$defs/AggregationSpec"},"title":"Aggregations","type":"array"},"case_sensitivity":{"default":false,"title":"Case Sensitivity","type":"boolean"},"filters":{"anyOf":[{"$ref":"#/$defs/ComparisonFilter"},{"$ref":"#/$defs/LogicalFilter"},{"type":"null"}],"default":null,"title":"Filters"},"group_by":{"items":{"$ref":"#/$defs/GroupBySpec"},"title":"Group By","type":"array"},"limit":{"anyOf":[{"type":"integer"},{"type":"null"}],"default":1000,"title":"Limit"},"offset":{"anyOf":[{"type":"integer"},{"type":"null"}],"default":0,"title":"Offset"},"op":{"const":"query","default":"query","title":"Op","type":"string"},"relations":{"items":{"enum":["orders_to_customers","items_to_orders","items_to_products"],"type":"string"},"title":"Relations","type":"array"},"root_entity":{"enum":["customers","products","orders","order_items"],"title":"Root Entity","type":"string"},"select":{"items":{"$ref":"#/$defs/SelectExpr"},"title":"Select","type":"array"},"semantic_clauses":{"items":{"$ref":"#/$defs/SemanticClause"},"title":"Semantic Clauses","type":"array"}},"required":["root_entity"],"title":"RelationalQuery","type":"object"}]}}},"schema_ref":"schema_v1","user_query":"Расскажи всё о клиенте 42: профиль (city, segment, signup_date), количество заказов, общая сумма, дата/статус/канал последнего заказа и 5 самых дорогих покупок (по line_total)."},"run_id":"9df66f32","timestamp":"2026-01-23T10:25:59.312378Z","type":"planner_input","v":1}},"resources":{},"root":{"case_id":"qa_001","diag":{"selectors_valid_after":true,"selectors_valid_before":true},"expected":{"out_spec":{"mode":"slice","provider":"demo_qa","selectors":{"aggregations":[{"agg":"count","alias":"order_count","field":"order_id"},{"agg":"sum","alias":"total_spent","field":"order_total"}],"filters":{"field":"customer_id","op":"=","type":"comparison","value":42},"group_by":[{"alias":"customer_id","field":"customer_id"}],"limit":1,"op":"query","relations":["orders_to_customers"],"root_entity":"customers","select":[{"alias":"city","expr":"city"},{"alias":"segment","expr":"segment"},{"alias":"signup_date","expr":"signup_date"}]}}},"id":"plan_normalize.spec_v1","input":{"normalizer_rules":{"demo_qa":"relational_v1"},"options":{"allow_unknown_providers":false,"coerce_provider_case":true,"dedupe_context_plan":true,"dedupe_required_context":true,"default_mode":"full","filter_selectors_by_schema":true,"trim_text_fields":true},"spec":{"mode":"slice","provider":"demo_qa","selectors":{"aggregations":[{"agg":"count","alias":"order_count","field":"order_id"},{"agg":"sum","alias":"total_spent","field":"order_total"}],"filters":{"field":"customer_id","op":"=","type":"comparison","value":42},"group_by":[{"alias":"customer_id","field":"customer_id"}],"limit":1,"op":"query","relations":["orders_to_customers"],"root_entity":"customers","select":[{"alias":"city","expr":"city"},{"alias":"segment","expr":"segment"},{"alias":"signup_date","expr":"signup_date"}]}}},"meta":{"mode":"slice","provider":"demo_qa","spec_idx":0},"note":"{\"provider\": \"demo_qa\", \"selectors_validate_before\": \"ok\", \"selectors_validate_after\": \"ok\", \"selectors_normalization_decision\": \"keep_original_valid\"}","requires":["planner_input_v1"],"run_id":"9df66f32","source":{"case_id":"qa_001","event_index":4,"events_path":"_demo_data/shop/.runs/runs/20260123_132552_retail_cases/cases/qa_001_713263cb/events.jsonl","picked":"latest_non_missed","run_dir":"_demo_data/shop/.runs/runs/20260123_132552_retail_cases/cases/qa_001_713263cb","tag":null},"timestamp":"2026-01-23T10:25:59.327950Z","type":"replay_point","v":1},"source":{"case_id":"qa_001","event_index":4,"events_path":"_demo_data/shop/.runs/runs/20260123_132552_retail_cases/cases/qa_001_713263cb/events.jsonl","picked":"latest_non_missed","tag":null},"type":"replay_bundle","v":1}